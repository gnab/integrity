<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Capture</title>
  </head>
  <body>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script type="text/javascript">
      (function poll(){
        console.log('Waiting for tests...')
        $.ajax({ 
          url: '/run'
        , dataType: 'json'
        , timeout: 30000
        , success: function(data) {
            console.log('Received test: ' + data);
            var result = eval(data);
            console.log('Sending result: ' + result);
            $.post('/result', result, function success () {
              poll();
            });
          }
        , error: function (err) {
            console.log('Unable to poll, make sure server is running.')
          }});
      })();  
    </script>
  </body>
</html>
